<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Report | Rapid Pro Maintenance</title>
    <meta name="description" content="Preventative maintenance final report and summary">
    <link rel="icon" type="image/svg+xml" href="../assets/images/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/dashboard.css">
    <link rel="stylesheet" href="styles/dashboard-main.css">
    <link rel="stylesheet" href="styles/pm-session.css">
    <link rel="stylesheet" href="styles/pdf-export.css">
    <meta name="theme-color" content="#1f2937">
    
    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="src/css/bridge-building.css">
</head>
<body class="bridge-building-mode">
    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="../assets/images/logo.png" alt="Rapid Pro Maintenance" class="sidebar-logo">
                <button class="sidebar-toggle" aria-label="Toggle sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li>
                        <a href="dashboard.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                            Dashboard
                        </a>
                    </li>
                    <li class="active">
                        <a href="pm-sessions.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            Bridge Building Visits
                        </a>
                    </li>
                    <li>
                        <a href="customers.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            Customers
                        </a>
                    </li>
                    <li>
                        <a href="schedule.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            Schedule
                        </a>
                    </li>
                    <li>
                        <a href="reports.html">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            Reports
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="settings.html" class="sidebar-footer-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                    Settings
                </a>
                <a href="index.html" class="sidebar-footer-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Logout
                </a>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Navigation -->
            <header class="top-nav">
                <button class="menu-toggle" aria-label="Toggle menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <div class="page-title">Final Report</div>
                <div class="top-nav-actions">
                    <button class="save-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Save Progress
                    </button>
                </div>
            </header>

            <!-- Bridge Building Visit Content -->
            <div class="pm-session-content">
                <!-- Session Header -->
                <div class="session-header">
                    <div class="customer-details">
                        <h1>TJ's Bar & Grill</h1>
                        <p>789 Downtown Blvd, Memphis, TN</p>
                        <div class="session-meta">
                            <span class="session-date">May 10, 2025</span>
                            <span class="separator">â€¢</span>
                            <span class="technician">John Smith</span>
                        </div>
                    </div>
                    <div class="session-status">
                        <div class="status-badge in-progress">In Progress</div>
                    </div>
                </div>

                <!-- Progress Tracker -->
                <div class="progress-tracker">
                    <div class="progress-steps">
                        <div class="progress-step completed">
                            <div class="step-number">1</div>
                            <div class="step-label">Client Identification</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">2</div>
                            <div class="step-label">Work Authorization</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">3</div>
                            <div class="step-label">Equipment Identification</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">4</div>
                            <div class="step-label">Temperature & Gasket</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">5</div>
                            <div class="step-label">Sink & Plumbing</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">6</div>
                            <div class="step-label">Coil Cleaning</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">7</div>
                            <div class="step-label">Gas Equipment</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">8</div>
                            <div class="step-label">Minor Repairs</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">9</div>
                            <div class="step-label">Rooftop Maintenance</div>
                        </div>
                        <div class="progress-step active">
                            <div class="step-number">10</div>
                            <div class="step-label">Final Report</div>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 95%;"></div>
                    </div>
                </div>

                <!-- Report Section -->
                <div class="inspection-form">
                    <div class="form-section">
                        <h2 class="form-section-title">Final Report & Summary</h2>
                        <p class="form-section-description">Review completed work, add final notes, and complete the PM session.</p>
                        
                        <!-- PM Summary Section -->
                        <div class="report-section">
                            <h3 class="form-subsection-title">Restaurant Relations Summary</h3>
                            
                            <!-- Summary Elements -->
                            <div class="summary-grid">
                                <div class="summary-card">
                                    <div class="summary-icon success">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </div>
                                    <div class="summary-content">
                                        <h4>Equipment Inspected</h4>
                                        <div class="summary-value">7</div>
                                    </div>
                                </div>
                                
                                <div class="summary-card">
                                    <div class="summary-icon warning">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                            <line x1="12" y1="9" x2="12" y2="13"></line>
                                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                        </svg>
                                    </div>
                                    <div class="summary-content">
                                        <h4>Issues Found</h4>
                                        <div class="summary-value">3</div>
                                    </div>
                                </div>
                                
                                <div class="summary-card">
                                    <div class="summary-icon info">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                            <polyline points="10 9 9 9 8 9"></polyline>
                                        </svg>
                                    </div>
                                    <div class="summary-content">
                                        <h4>Tasks Completed</h4>
                                        <div class="summary-value">12</div>
                                    </div>
                                </div>
                                
                                <div class="summary-card">
                                    <div class="summary-icon danger">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <line x1="12" y1="8" x2="12" y2="12"></line>
                                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                        </svg>
                                    </div>
                                    <div class="summary-content">
                                        <h4>Critical Repairs Needed</h4>
                                        <div class="summary-value">1</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Summary Notes -->
                            <div class="form-group">
                                <label class="form-label">Summary Notes</label>
                                <textarea class="form-control textarea" id="summary-notes" rows="4" placeholder="Enter a comprehensive summary of the PM service performed..."></textarea>
                            </div>
                        </div>
                        
                        <!-- PM Report Preview -->
                        <div class="report-section">
                            <h3 class="form-subsection-title">PM Report Preview</h3>
                            
                            <div class="report-preview-container">
                                <div class="report-preview">
                                    <div class="report-header">
                                        <div class="report-title">
                                            <h2>RAPID PRO MAINTENANCE</h2>
                                            <h3>Restaurant Relations Report</h3>
                                        </div>
                                        <div class="report-logo">
                                            <img src="../assets/images/logo.png" alt="Rapid Pro Maintenance Logo">
                                        </div>
                                    </div>
                                    
                                    <div class="report-meta">
                                        <div class="meta-item">
                                            <div class="meta-label">Customer:</div>
                                            <div class="meta-value">TJ's Bar & Grill</div>
                                        </div>
                                        <div class="meta-item">
                                            <div class="meta-label">Address:</div>
                                            <div class="meta-value">789 Downtown Blvd, Memphis, TN</div>
                                        </div>
                                        <div class="meta-item">
                                            <div class="meta-label">Date:</div>
                                            <div class="meta-value">May 10, 2025</div>
                                        </div>
                                        <div class="meta-item">
                                            <div class="meta-label">Technician:</div>
                                            <div class="meta-value">John Smith</div>
                                        </div>
                                    </div>
                                    
                                    <div class="report-section-preview">
                                        <h4>Equipment Inspected</h4>
                                        <ul class="report-list">
                                            <li><span class="condition excellent">Walk-In Cooler (Excellent)</span></li>
                                            <li><span class="condition good">Reach-In Cooler #1 (Good)</span></li>
                                            <li><span class="condition attention">Reach-In Cooler #2 (Needs Gasket)</span></li>
                                            <li><span class="condition good">Ice Machine (Good)</span></li>
                                            <li><span class="condition good">Gas Range (Good)</span></li>
                                            <li><span class="condition good">Deep Fryer (Good)</span></li>
                                            <li><span class="condition attention">Rooftop RTU #1 (Filter Replaced)</span></li>
                                        </ul>
                                    </div>
                                    
                                    <div class="report-section-preview">
                                        <h4>Actions Performed</h4>
                                        <ul class="report-list">
                                            <li>Cleaned all condenser coils</li>
                                            <li>Replaced air filters on RTU #1</li>
                                            <li>Inspected and verified all door gaskets</li>
                                            <li>Verified temperature calibration</li>
                                            <li>Checked gas line conditions</li>
                                            <li>Replaced washers on mop sink faucet</li>
                                            <li>Tightened loose faucets</li>
                                            <li>Resolved dripping issues at prep sink</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="report-section-preview">
                                        <h4>Recommendations</h4>
                                        <ul class="report-list recommendations">
                                            <li><span class="priority high">Replace door gasket on Reach-In #2</span></li>
                                            <li><span class="priority medium">Schedule deep cleaning of ice machine</span></li>
                                            <li><span class="priority low">Consider replacement fan belt for RTU #1</span></li>
                                        </ul>
                                    </div>
                                    
                                    <div class="report-signatures">
                                        <div class="signature-block">
                                            <div class="signature-line"></div>
                                            <div class="signature-label">Customer Signature</div>
                                        </div>
                                        <div class="signature-block">
                                            <div class="signature-line"></div>
                                            <div class="signature-label">Technician Signature</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Report Actions -->
                            <div class="report-actions">
                                <button type="button" class="btn-outline" id="preview-pdf-btn">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                    Preview PDF
                                </button>
                                <button type="button" class="btn-outline" id="download-pdf-btn">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Download PDF
                                </button>
                                <button type="button" class="btn-outline" id="print-pdf-btn">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                                        <rect x="6" y="14" width="12" height="8"></rect>
                                    </svg>
                                    Print Report
                                </button>
                            </div>
                        </div>
                        
                        <!-- Email Report Section -->
                        <div class="report-section">
                            <h3 class="form-subsection-title">Email Report</h3>
                            
                            <div class="form-group">
                                <div class="toggle-container">
                                    <label class="form-label">Email Report to Customer</label>
                                    <div class="toggle-switch">
                                        <input type="checkbox" id="email-report" class="toggle-input">
                                        <label for="email-report" class="toggle-label">
                                            <span class="toggle-inner"></span>
                                            <span class="toggle-switch-label">No</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div id="email-section" class="conditional-section" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label" for="recipient-email">Recipient Email</label>
                                            <input type="email" id="recipient-email" class="form-control" placeholder="Enter customer email">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="cc-emails">CC Additional Recipients</label>
                                            <input type="text" id="cc-emails" class="form-control" placeholder="Separate emails with commas">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="email-subject">Email Subject</label>
                                        <input type="text" id="email-subject" class="form-control" value="Restaurant Relations Report - TJ's Bar & Grill">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="email-message">Email Message</label>
                                        <textarea id="email-message" class="form-control textarea" rows="4">Dear valued customer,

Please find attached the preventative maintenance report from our recent service visit. This report details all inspections performed, actions taken, and any recommendations for future maintenance or repairs.

If you have any questions or would like to schedule follow-up service, please contact us.

Best regards,
Rapid Pro Maintenance Team</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Customer Signature -->
                        <div class="report-section">
                            <h3 class="form-subsection-title">Customer Signature on Completion</h3>
                            
                            <div class="form-group">
                                <label class="form-label">Customer Signature</label>
                                <div class="signature-container">
                                    <canvas id="signature-pad" class="signature-pad"></canvas>
                                    <div class="signature-pad-actions">
                                        <button type="button" id="clear-signature" class="btn-outline btn-sm">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M3 6h18"></path>
                                                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                                            </svg>
                                            Clear Signature
                                        </button>
                                    </div>
                                    <div class="signature-instructions">Sign with your finger or mouse in the box above.</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="customer-name">Customer Name</label>
                                <input type="text" id="customer-name" class="form-control" placeholder="Enter customer's full name" required>
                            </div>
                        </div>
                        
                        <!-- PM Completion Confirmation -->
                        <div class="form-group service-confirmation">
                            <p class="service-note">Please confirm completion of this preventative maintenance service:</p>
                            <label class="checkbox-option">
                                <input type="checkbox" id="pm-completed-confirmed">
                                <span class="checkbox-label">I confirm that all preventative maintenance tasks have been completed, the report has been reviewed with the customer, and all information is accurate.</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="window.location.href='pm-rooftop-maintenance.html'">Previous: Rooftop Maintenance</button>
                        <div class="action-right">
                            <button type="button" class="btn-outline">Save Draft</button>
                            <button type="button" id="complete-btn" class="btn-success" disabled>Complete Bridge Building Visit</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Custom styles -->
    <style>
        .toggle-switch {
            position: relative;
            display: inline-block;
            margin-top: 8px;
        }
        
        .toggle-input {
            display: none;
        }
        
        .toggle-label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .toggle-inner {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            background-color: var(--gray);
            border-radius: 12px;
            transition: all var(--transition-normal) ease;
            margin-right: 10px;
        }
        
        .toggle-inner:before {
            content: "";
            position: absolute;
            left: 2px;
            top: 2px;
            width: 20px;
            height: 20px;
            background-color: var(--white);
            border-radius: 50%;
            transition: all var(--transition-normal) ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .toggle-input:checked + .toggle-label .toggle-inner {
            background-color: var(--success);
        }
        
        .toggle-input:checked + .toggle-label .toggle-inner:before {
            transform: translateX(26px);
        }
        
        .toggle-input:checked + .toggle-label .toggle-switch-label {
            content: "Yes";
        }
        
        .toggle-input:checked + .toggle-label .toggle-switch-label:after {
            content: "Yes";
        }
        
        .report-section {
            background-color: var(--white);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            border: 1px solid var(--gray);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }
        
        .summary-card {
            background-color: var(--light-gray);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }
        
        .summary-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .summary-icon.success {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .summary-icon.warning {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .summary-icon.info {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }
        
        .summary-icon.danger {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }
        
        .summary-content h4 {
            font-size: 0.875rem;
            margin: 0 0 var(--spacing-xs) 0;
            color: var(--darker-gray);
        }
        
        .summary-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
        }
        
        .report-preview-container {
            background-color: var(--light-gray);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            max-height: 600px;
            overflow-y: auto;
            border: 1px solid var(--gray);
        }
        
        .report-preview {
            background-color: var(--white);
            box-shadow: var(--shadow-sm);
            padding: var(--spacing-lg);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-md);
            border-bottom: 2px solid var(--primary);
        }
        
        .report-title h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin: 0 0 var(--spacing-xs) 0;
        }
        
        .report-title h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--darker-gray);
            margin: 0;
        }
        
        .report-logo img {
            height: 50px;
            width: auto;
        }
        
        .report-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md) var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
        }
        
        .meta-item {
            display: flex;
            gap: var(--spacing-sm);
        }
        
        .meta-label {
            font-weight: 600;
            color: var(--darker-gray);
            min-width: 90px;
        }
        
        .meta-value {
            color: var(--text);
        }
        
        .report-section-preview {
            margin-bottom: var(--spacing-lg);
        }
        
        .report-section-preview h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            margin: 0 0 var(--spacing-sm) 0;
            padding-bottom: var(--spacing-xs);
            border-bottom: 1px solid var(--gray);
        }
        
        .report-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        
        .report-list li {
            position: relative;
            padding-left: 24px;
            margin-bottom: var(--spacing-sm);
            line-height: 1.4;
        }
        
        .report-list li::before {
            content: "â€¢";
            position: absolute;
            left: 8px;
            color: var(--accent);
        }
        
        .condition {
            font-weight: 500;
        }
        
        .condition.excellent {
            color: var(--success);
        }
        
        .condition.good {
            color: var(--info);
        }
        
        .condition.attention {
            color: var(--warning);
        }
        
        .condition.poor {
            color: var(--danger);
        }
        
        .recommendations .priority {
            font-weight: 500;
        }
        
        .priority.high {
            color: var(--danger);
        }
        
        .priority.medium {
            color: var(--warning);
        }
        
        .priority.low {
            color: var(--info);
        }
        
        .report-signatures {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--gray);
        }
        
        .signature-block {
            width: 45%;
        }
        
        .signature-line {
            height: 1px;
            background-color: var(--darker-gray);
            margin-bottom: var(--spacing-xs);
        }
        
        .signature-label {
            font-size: 0.875rem;
            color: var(--darker-gray);
            text-align: center;
        }
        
        .report-actions {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
        }
        
        .report-actions button {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-sm);
        }
        
        .conditional-section {
            animation: fadeIn 0.3s ease;
            margin-top: var(--spacing-md);
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        .signature-container {
            margin-bottom: var(--spacing-md);
        }
        
        .signature-pad {
            width: 100%;
            height: 150px;
            background-color: var(--white);
            border: 1px solid var(--gray);
            border-radius: var(--radius-md);
            touch-action: none;
        }
        
        .signature-pad-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: var(--spacing-sm);
        }
        
        .signature-instructions {
            font-size: 0.75rem;
            color: var(--dark-gray);
            text-align: center;
            margin-top: var(--spacing-sm);
        }
        
        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }
        
        .service-confirmation {
            background-color: var(--light);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            border-left: 3px solid var(--accent);
            margin-top: var(--spacing-xl);
        }
        
        .service-note {
            font-weight: 500;
            margin-bottom: var(--spacing-sm);
        }
        
        .btn-success {
            padding: var(--spacing-sm) var(--spacing-lg);
            background-color: var(--success);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast) ease;
        }
        
        .btn-success:hover {
            background-color: #0d9488;
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }
        
        .btn-success:disabled {
            background-color: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        @media (max-width: 992px) {
            .report-meta {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .report-header {
                flex-direction: column;
                gap: var(--spacing-md);
                text-align: center;
            }
            
            .report-signatures {
                flex-direction: column;
                gap: var(--spacing-lg);
            }
            
            .signature-block {
                width: 100%;
            }
            
            .report-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .report-actions button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <script src="src/js/pdf-export.js"></script>
    <script>
        // Mobile menu toggle
        document.querySelector('.menu-toggle').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });
        
        // Sidebar toggle for smaller screens
        document.querySelector('.sidebar-toggle').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });
        
        // Signature pad initialization
        let signaturePad;
        
        function initializeSignaturePad() {
            const canvas = document.getElementById('signature-pad');
            
            // Set canvas dimensions based on container
            resizeCanvas();
            
            // Initialize SignaturePad
            signaturePad = new SignaturePad(canvas, {
                minWidth: 1,
                maxWidth: 3,
                penColor: 'black',
                backgroundColor: 'rgba(255, 255, 255, 0)'
            });
            
            // Clear button
            document.getElementById('clear-signature').addEventListener('click', function() {
                signaturePad.clear();
                validateForm();
            });
            
            // Handle resize
            window.addEventListener('resize', resizeCanvas);
        }
        
        function resizeCanvas() {
            const canvas = document.getElementById('signature-pad');
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            
            canvas.width = canvas.offsetWidth * ratio;
            canvas.height = canvas.offsetHeight * ratio;
            canvas.getContext("2d").scale(ratio, ratio);
            
            // If signature pad is already initialized, clear it
            if (signaturePad) {
                signaturePad.clear();
            }
        }
        
        // Toggle switch functionality
        const emailReportToggle = document.getElementById('email-report');
        const emailLabel = emailReportToggle.nextElementSibling.querySelector('.toggle-switch-label');
        const emailSection = document.getElementById('email-section');
        
        emailReportToggle.addEventListener('change', function() {
            emailLabel.textContent = this.checked ? 'Yes' : 'No';
            emailSection.style.display = this.checked ? 'block' : 'none';
            
            // If email option is enabled, make email fields required
            const emailField = document.getElementById('recipient-email');
            if (this.checked) {
                emailField.setAttribute('required', 'required');
            } else {
                emailField.removeAttribute('required');
            }
            
            validateForm();
        });
        
        // PDF actions are now handled by pdf-export.js
        
        // Form validation for required fields
        const pmCompletedConfirmed = document.getElementById('pm-completed-confirmed');
        const customerNameInput = document.getElementById('customer-name');
        const completeButton = document.getElementById('complete-btn');
        
        // Function to check if we can enable the Complete button
        function validateForm() {
            const hasSignature = !signaturePad.isEmpty();
            const hasCustomerName = customerNameInput.value.trim() !== '';
            const isConfirmed = pmCompletedConfirmed.checked;
            
            // Validate email if that option is checked
            let emailValid = true;
            if (emailReportToggle.checked) {
                const emailInput = document.getElementById('recipient-email');
                emailValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value);
                
                if (!emailValid) {
                    emailInput.classList.add('invalid');
                } else {
                    emailInput.classList.remove('invalid');
                }
            }
            
            // Apply validation styles to customer name field
            if (!hasCustomerName) {
                customerNameInput.classList.add('invalid');
            } else {
                customerNameInput.classList.remove('invalid');
            }
            
            // Enable/disable complete button
            if (hasSignature && hasCustomerName && isConfirmed && emailValid) {
                completeButton.disabled = false;
            } else {
                completeButton.disabled = true;
            }
        }
        
        // Add validation listeners
        pmCompletedConfirmed.addEventListener('change', validateForm);
        customerNameInput.addEventListener('input', validateForm);
        
        document.getElementById('recipient-email').addEventListener('input', validateForm);
        
        // Add signature validation
        const signaturePadCanvas = document.getElementById('signature-pad');
        signaturePadCanvas.addEventListener('mouseup', validateForm);
        signaturePadCanvas.addEventListener('touchend', validateForm);
        
        // Complete button click handler
        completeButton.addEventListener('click', function() {
            // Save form data and complete the session
            saveFormData();
            
            // Show success message
            alert('Bridge Building Visit completed successfully! Redirecting to dashboard.');
            
            // Redirect to PM sessions list
            window.location.href = 'pm-sessions.html';
        });
        
        // Save form data function (would connect to backend in production)
        function saveFormData() {
            // Get equipment, issues, tasks and critical repairs counts from the report
            const equipmentCount = parseInt(document.querySelector('.summary-card:nth-of-type(1) .summary-value').textContent) || 0;
            const issuesCount = parseInt(document.querySelector('.summary-card:nth-of-type(2) .summary-value').textContent) || 0;
            const tasksCount = parseInt(document.querySelector('.summary-card:nth-of-type(3) .summary-value').textContent) || 0;
            const criticalCount = parseInt(document.querySelector('.summary-card:nth-of-type(4) .summary-value').textContent) || 0;
            
            // Gather equipment list
            const equipmentItems = [];
            const equipmentElements = document.querySelectorAll('.report-section-preview:nth-of-type(1) .report-list li');
            equipmentElements.forEach(element => {
                const text = element.textContent;
                if (text) {
                    equipmentItems.push(text);
                }
            });
            
            // Gather actions performed
            const actionsPerformed = [];
            const actionElements = document.querySelectorAll('.report-section-preview:nth-of-type(2) .report-list li');
            actionElements.forEach(element => {
                const text = element.textContent;
                if (text) {
                    actionsPerformed.push(text);
                }
            });
            
            // Gather recommendations
            const recommendations = [];
            const recommendationElements = document.querySelectorAll('.report-section-preview:nth-of-type(3) .report-list li');
            recommendationElements.forEach(element => {
                const text = element.textContent;
                if (text) {
                    // Extract priority from class
                    const priorityClass = element.querySelector('.priority');
                    let priority = 'medium';
                    if (priorityClass) {
                        if (priorityClass.classList.contains('high')) priority = 'high';
                        else if (priorityClass.classList.contains('low')) priority = 'low';
                    }
                    
                    recommendations.push({
                        text: text,
                        priority: priority
                    });
                }
            });
            
            const formData = {
                summary: {
                    notes: document.getElementById('summary-notes').value,
                    equipmentInspected: equipmentCount,
                    issuesFound: issuesCount,
                    tasksCompleted: tasksCount,
                    criticalRepairsNeeded: criticalCount,
                    equipmentItems: equipmentItems,
                    actionsPerformed: actionsPerformed,
                    recommendations: recommendations
                },
                email: {
                    sendEmail: emailReportToggle.checked,
                    recipientEmail: document.getElementById('recipient-email').value,
                    ccEmails: document.getElementById('cc-emails').value,
                    subject: document.getElementById('email-subject').value,
                    message: document.getElementById('email-message').value
                },
                signature: {
                    signatureDataUrl: signaturePad.toDataURL(),
                    customerName: customerNameInput.value
                },
                confirmed: pmCompletedConfirmed.checked,
                timestamp: new Date().toISOString(),
                // Store metadata
                completedAt: new Date().toISOString(),
                reportVersion: '1.0'
            };
            
            // In a real implementation, this would be saved to a database or localStorage
            console.log('Saving final report data:', formData);
            
            // For demo purposes, save to sessionStorage
            sessionStorage.setItem('finalReportData', JSON.stringify(formData));
            
            // In a real app, this would send the complete report to the server
            console.log('Bridge Building Visit completed and report saved with dynamic data!');
        }
        
        // Load data from all previous PM workflow steps
        function loadSavedData() {
            // First load any previously saved final report data
            const savedData = sessionStorage.getItem('finalReportData');
            if (savedData) {
                try {
                    const formData = JSON.parse(savedData);
                    
                    // Populate form with saved data
                    if (formData.summary) {
                        document.getElementById('summary-notes').value = formData.summary.notes || '';
                    }
                    
                    if (formData.email) {
                        emailReportToggle.checked = formData.email.sendEmail || false;
                        document.getElementById('recipient-email').value = formData.email.recipientEmail || '';
                        document.getElementById('cc-emails').value = formData.email.ccEmails || '';
                        document.getElementById('email-subject').value = formData.email.subject || 'Restaurant Relations Report - TJ\'s Bar & Grill';
                        document.getElementById('email-message').value = formData.email.message || '';
                        emailSection.style.display = formData.email.sendEmail ? 'block' : 'none';
                        emailLabel.textContent = formData.email.sendEmail ? 'Yes' : 'No';
                    }
                    
                    if (formData.signature) {
                        customerNameInput.value = formData.signature.customerName || '';
                    }
                    
                    pmCompletedConfirmed.checked = formData.confirmed || false;
                } catch (err) {
                    console.error('Error loading saved final report data:', err);
                }
            }
            
            // Now load and integrate data from all previous PM workflow steps
            loadWorkflowData();
            
            // Validate form after loading
            validateForm();
        }
        
        // Load and integrate data from all previous PM workflow steps
        function loadWorkflowData() {
            // Customer and session data
            let clientName = "";
            let businessName = "";
            let serviceAddress = "";
            let technicianName = "";
            let visitDate = "";
            
            try {
                const clientData = JSON.parse(sessionStorage.getItem('clientData') || '{}');
                if (clientData) {
                    clientName = clientData.customerName || '';
                    businessName = clientData.businessName || '';
                    serviceAddress = clientData.serviceAddress || '';
                    technicianName = clientData.technicianName || '';
                    visitDate = clientData.visitDate || '';
                    
                    // Update report meta information
                    document.querySelector('.meta-value:nth-of-type(1)').textContent = businessName;
                    document.querySelector('.meta-value:nth-of-type(2)').textContent = serviceAddress;
                    document.querySelector('.meta-value:nth-of-type(3)').textContent = formatDate(visitDate);
                    document.querySelector('.meta-value:nth-of-type(4)').textContent = technicianName;
                    
                    // Update email subject if not customized
                    if (!document.getElementById('email-subject').value || 
                        document.getElementById('email-subject').value === 'Restaurant Relations Report - TJ\'s Bar & Grill') {
                        document.getElementById('email-subject').value = `Restaurant Relations Report - ${businessName}`;
                    }
                }
            } catch (err) {
                console.error('Error loading client data:', err);
            }
            
            // Equipment data
            const equipmentItems = [];
            try {
                const equipmentData = JSON.parse(sessionStorage.getItem('equipmentData') || '[]');
                if (equipmentData && equipmentData.length) {
                    equipmentData.forEach(item => {
                        equipmentItems.push({
                            name: item.type || 'Unknown Equipment',
                            condition: item.condition || 'Good',
                            location: item.location || ''
                        });
                    });
                }
            } catch (err) {
                console.error('Error loading equipment data:', err);
            }
            
            // Temperature and gasket data
            try {
                const tempGasketData = JSON.parse(sessionStorage.getItem('temperatureGasketData') || '{}');
                if (tempGasketData && tempGasketData.inspections) {
                    tempGasketData.inspections.forEach(inspection => {
                        const equipmentItem = {
                            name: inspection.equipmentName || 'Unknown Equipment',
                            condition: getConditionFromTempData(inspection),
                            notes: inspection.notes || ''
                        };
                        equipmentItems.push(equipmentItem);
                    });
                }
            } catch (err) {
                console.error('Error loading temperature and gasket data:', err);
            }
            
            // Minor repairs data
            const actionsPerformed = [];
            const recommendations = [];
            try {
                const minorRepairsData = JSON.parse(sessionStorage.getItem('minorRepairsData') || '{}');
                if (minorRepairsData) {
                    // Add repair actions to actions performed list
                    if (minorRepairsData.repairsPerformed) {
                        const repairs = minorRepairsData.repairsPerformed;
                        
                        if (repairs.washersReplaced) {
                            actionsPerformed.push(`Replaced washers at ${repairs.washersLocation || 'various locations'}`);
                        }
                        
                        if (repairs.faucetsTightened) {
                            actionsPerformed.push(`Tightened faucets at ${repairs.faucetsLocation || 'various locations'}`);
                        }
                        
                        if (repairs.dripsResolved) {
                            actionsPerformed.push(`Resolved dripping issues at ${repairs.dripsLocation || 'various locations'}`);
                        }
                        
                        if (repairs.otherRepairs) {
                            actionsPerformed.push(repairs.otherRepairsDetails || 'Performed other minor repairs');
                        }
                    }
                    
                    // Add recommendations from minor repairs
                    if (minorRepairsData.futureRepairs && minorRepairsData.futureRepairs.length) {
                        minorRepairsData.futureRepairs.forEach(repair => {
                            const priority = repair.priority || 'medium';
                            recommendations.push({
                                text: repair.description || 'Unspecified repair needed',
                                priority: priority
                            });
                        });
                    }
                }
            } catch (err) {
                console.error('Error loading minor repairs data:', err);
            }
            
            // Add standard actions performed if not already present
            const standardActions = [
                'Cleaned condenser coils',
                'Inspected door gaskets',
                'Verified temperature calibration',
                'Checked refrigerant levels',
                'Inspected electrical connections'
            ];
            
            standardActions.forEach(action => {
                if (!actionsPerformed.includes(action)) {
                    actionsPerformed.push(action);
                }
            });
            
            // Update the report preview with equipment data
            updateEquipmentList(equipmentItems);
            
            // Update actions performed
            updateActionsList(actionsPerformed);
            
            // Update recommendations
            updateRecommendationsList(recommendations);
            
            // Update summary metrics
            document.querySelector('.summary-card:nth-of-type(1) .summary-value').textContent = equipmentItems.length || '0';
            document.querySelector('.summary-card:nth-of-type(2) .summary-value').textContent = recommendations.length || '0';
            document.querySelector('.summary-card:nth-of-type(3) .summary-value').textContent = actionsPerformed.length || '0';
            
            // Count critical repairs
            const criticalRepairs = recommendations.filter(rec => rec.priority === 'high').length;
            document.querySelector('.summary-card:nth-of-type(4) .summary-value').textContent = criticalRepairs || '0';
        }
        
        // Helper function to format date
        function formatDate(dateString) {
            if (!dateString) return '';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
            } catch (err) {
                return dateString;
            }
        }
        
        // Helper function to determine condition from temperature data
        function getConditionFromTempData(inspection) {
            if (!inspection) return 'Unknown';
            
            if (inspection.tempInRange === false || 
                (inspection.gasketCondition && inspection.gasketCondition === 'Replace')) {
                return 'Needs Attention';
            }
            
            if (inspection.gasketCondition && inspection.gasketCondition === 'Excellent') {
                return 'Excellent';
            }
            
            return 'Good';
        }
        
        // Update equipment list in the report preview
        function updateEquipmentList(equipmentItems) {
            const equipmentList = document.querySelector('.report-section-preview:nth-of-type(1) .report-list');
            if (!equipmentList || !equipmentItems.length) return;
            
            let listHTML = '';
            equipmentItems.forEach(item => {
                const conditionClass = getConditionClass(item.condition);
                listHTML += `<li><span class="condition ${conditionClass}">${item.name} (${item.condition})</span></li>`;
            });
            
            if (listHTML) {
                equipmentList.innerHTML = listHTML;
            }
        }
        
        // Update actions list in the report preview
        function updateActionsList(actions) {
            const actionsList = document.querySelector('.report-section-preview:nth-of-type(2) .report-list');
            if (!actionsList || !actions.length) return;
            
            let listHTML = '';
            actions.forEach(action => {
                listHTML += `<li>${action}</li>`;
            });
            
            if (listHTML) {
                actionsList.innerHTML = listHTML;
            }
        }
        
        // Update recommendations list in the report preview
        function updateRecommendationsList(recommendations) {
            const recommendationsList = document.querySelector('.report-section-preview:nth-of-type(3) .report-list');
            if (!recommendationsList || !recommendations.length) return;
            
            let listHTML = '';
            recommendations.forEach(rec => {
                listHTML += `<li><span class="priority ${rec.priority}">${rec.text}</span></li>`;
            });
            
            if (listHTML) {
                recommendationsList.innerHTML = listHTML;
            }
        }
        
        // Helper function to get condition class for styling
        function getConditionClass(condition) {
            condition = condition.toLowerCase();
            if (condition.includes('excellent')) return 'excellent';
            if (condition.includes('good')) return 'good';
            if (condition.includes('needs') || condition.includes('replace') || condition.includes('attention')) return 'attention';
            return 'good'; // Default
        }
        
        // Initialize the form
        document.addEventListener('DOMContentLoaded', function() {
            initializeSignaturePad();
            loadSavedData();
        });
    </script>
    <script src="../src/js/bridge-building-implementation.js"></script>
</body>
</html>